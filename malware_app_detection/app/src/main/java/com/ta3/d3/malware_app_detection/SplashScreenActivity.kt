package com.ta3.d3.malware_app_detection

import android.content.Context
import android.content.Intent
import android.os.Bundle
import android.os.Handler
import androidx.appcompat.app.AppCompatActivity
import com.ta3.d3.malware_app_detection.db.AppDatabase
import com.ta3.d3.malware_app_detection.db.entities.User
import kotlinx.coroutines.CoroutineScope
import kotlinx.coroutines.Dispatchers
import kotlinx.coroutines.launch

class SplashScreenActivity : AppCompatActivity() {
    val db by lazy { AppDatabase(this) }
    override fun onCreate(savedInstanceState: Bundle?) {
        super.onCreate(savedInstanceState)
        setContentView(R.layout.activity_splash_screen)

        supportActionBar?.hide()

        val sharedPref  = getSharedPreferences("APP_BEHAVIOR", Context.MODE_PRIVATE)


//        memberi waktu
        Handler().postDelayed({
            CoroutineScope(Dispatchers.IO).launch {
                var found = db.userDao().loadAllByIds(intArrayOf(1))
                if(found.isEmpty()){
                    db.userDao().insertAll( User(1, "maltor application", "maltorapp@gmail.com", "081298765432"))
                }
            }
//            kalau yang pertama sekali diinstall akan menampilkan splash screen
            if(sharedPref.getBoolean("FIRST_TIME", true)){
                startActivity(Intent(this.applicationContext, TutorialSplashActivity::class.java))
            }else{
//                kalau tidak akan menampilkan
                startActivity(Intent(this.applicationContext, MainActivity::class.java))
            }
            finish()
        }, 2000)
//        waktu splash_screen selama 2 detik
    }
}