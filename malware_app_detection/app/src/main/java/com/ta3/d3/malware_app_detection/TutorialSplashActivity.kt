package com.ta3.d3.malware_app_detection

import android.content.Context
import android.content.Intent
import androidx.appcompat.app.AppCompatActivity
import android.os.Bundle
import android.os.Handler
import android.os.Looper
import android.util.Log
import android.view.View
import androidx.fragment.app.FragmentActivity
import com.google.android.material.tabs.TabLayoutMediator
import com.ta3.d3.malware_app_detection.adapter.TutorialPagerAdapter
import com.ta3.d3.malware_app_detection.databinding.ActivityTutorialSplashBinding

class TutorialSplashActivity : AppCompatActivity() {
    private lateinit var binding: ActivityTutorialSplashBinding
    override fun onCreate(savedInstanceState: Bundle?) {
        super.onCreate(savedInstanceState)
        supportActionBar?.hide()
        binding = ActivityTutorialSplashBinding.inflate(layoutInflater)
        val view = binding.root
        setContentView(view)
//        sharedPreferences digunakan untuk tempat penyimpanan primitif (int, bool, long, short) untuk penyimpanan data yang sedikit
//        companion object  -> mengakses member dari suatu kelas tanpa melalui objek
//        karakter penyimpanan menggunakan key values storage
        val sharedPref  = getSharedPreferences("APP_BEHAVIOR", Context.MODE_PRIVATE)
        val adapter = TutorialPagerAdapter(this)
        binding.tutorialViewpager.adapter = adapter

//        mengatur button Skip pada landing page agar ketika di klik menuju main activity
        binding.btnSkip.setOnClickListener {
            with(sharedPref?.edit()){
                this?.putBoolean("FIRST_TIME", false)
                this?.apply()
            }
            startActivity(Intent(it.context, MainActivity::class.java))
            //                finish ketika di back
            finish()
        }

        //        mengatur button next pada landing page
        binding.btnNext.setOnClickListener {

            if(binding.tutorialViewpager.currentItem < 2){
                binding.tutorialViewpager.currentItem += 1
//              membuat btn next dan btn skip gone saat landing page ketiga
                if(binding.tutorialViewpager.currentItem == 2){
                    binding.btnNext.visibility = View.GONE
                    binding.btnSkip.visibility = View.GONE
                }
            }else{
                with(sharedPref?.edit()){
                    this?.putBoolean("FIRST_TIME", false)
                    this?.apply()
                }
                startActivity(Intent(it.context, MainActivity::class.java))
//                finish ketika di back
                finish()
            }
        }

        TabLayoutMediator(binding.tutorialTablayout, binding.tutorialViewpager){ tab, position ->

        }.attach()
    }

}